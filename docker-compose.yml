version: '3.9'
services:

  veritabani:    #servisin adi
    image: mysql:8
    container_name: ortak_veritabani
    environment:
      MYSQL_DATABASE: kutuphane
      MYSQL_USER: admin
      MYSQL_PASSWORD: admin123
      MYSQL_ROOT_PASSWORD: root123 # root ÅŸifresi de lazÄ±m MySQLâ€™de ğŸ’â€â™€ï¸
    ports:
      - "3306:3306"
    volumes:
      - mysql_data:/var/lib/mysql

  veritabani-servisi:
    build: ./Veritabani_Servisi #Veritabani_Servisi klasÃ¶rÃ¼nde bir Dockerfile var. #Git onu kullan, image oluÅŸtur ve bu servisi baÅŸlat."Yani Compose, o klasÃ¶rdeki Dockerfile'Ä± kendi iÃ§inde kullanÄ±r.                                           
    depends_on:
      - veritabani
    command: ["/wait-for-it.sh", "veritabani:3306", "--", "java", "-jar", "veritabaniservis.jar"]


  kullanici-servisi:
    build: ./Kullanici_Servisi 
    depends_on:
     - veritabani
    ports:
     - "8080:8080"  # API'nin 8080 portunu expose ediyoruz
    command: ["/wait-for-it.sh", "veritabani:3306", "--", "java", "-jar", "kullaniciservis.jar"]

  kitap-servisi:
    build: ./Kitap_Servisi
    depends_on: 
     - veritabani
    ports:
      - "8081:8081"
    command: ["/wait-for-it.sh", "veritabani:3306", "--", "java", "-jar", "kitapservis.jar"]

  odunc-servisi:
    build: ./Odunc_Servisi
    depends_on:
      - veritabani
    ports:
      - "8082:8082"
    command: ["/wait-for-it.sh", "veritabani:3306", "--", "java", "-jar", "oduncservis.jar"]

  bildirim-servisi:
    build: ./Bildirim_Servisi
    depends_on:
      - veritabani
    ports:
      - "8083:8083"
    command: [ "/wait-for-it.sh", "veritabani:3306", "--", "java", "-jar", "bildirimservis.jar" ]

volumes:
  mysql_data: